var socialTimeSnapshotBookmarklet=socialTimeSnapshotBookmarklet||function(a){var b,c,d,e;b={controlId:"sts-controls",dataId:"sts-data",dataLabelText:"capture data",captureButtonText:"copy",loadButtonText:"paste",controlWrapperStyles:{background:"#A71930","border-radius":"3px",left:"5px",padding:"10px 5px",position:"absolute",top:"5px"},buttonStyles:{background:"#2e2e2e","border-radius":"3px",color:"#eee",cursor:"pointer",display:"inline-block","font-size":"11px",margin:"0 5px",padding:"5px 10px","text-transform":"uppercase"},flashStyles:{background:"#fff",bottom:"0",left:"0",position:"absolute",right:"0",top:"0","z-index":"4000",opacity:"1","-webkit-transition":"opacity 500ms ease-out","-moz-transition":"opacity 500ms ease-out","-ms-transition":"opacity 500ms ease-out",transition:"opacity 500ms ease-out"},dataWrapperStyles:{margin:"5px 5px 0 5px"},dataCheckboxStyles:{display:"inline","vertical-align":"middle"},dataLabelStyles:{display:"inline","font-size":"10px","text-transform":"uppercase"}},c={body:a("body"),controlWrapper:a("<div>"),captureButton:a("<a>"),loadButton:a("<a>"),dataWrapper:a("<div>"),dataCheckbox:a("<input>"),dataLabel:a("<label>"),taskList:a("#AllTab").children(".hcf-TaskList"),timeList:a("#hcf-TimeSheet-TaskArea").children(".hcf-TimeSheet-List")},d={},e={},handlers={},handlers.clickCapture=function(a){a&&a.preventDefault(),e.saveEntries(e.captureEntries())},handlers.clickLoad=function(a){a&&a.preventDefault(),e.populateEntries(e.retrieveEntries())},e.addControls=function(){c.loadButton.css(b.buttonStyles).text(b.loadButtonText).bind("click",handlers.clickLoad),c.captureButton.css(b.buttonStyles).text(b.captureButtonText).bind("click",handlers.clickCapture),c.dataCheckbox.css(b.dataCheckboxStyles).attr({type:"checkbox",id:"sts-dataCheckbox",checked:!0}),c.dataLabel.css(b.dataLabelStyles).text(b.dataLabelText).attr("for","sts-dataCheckbox"),c.dataWrapper.css(b.dataWrapperStyles).append(c.dataCheckbox).append(c.dataLabel),c.controlWrapper.attr("id",b.controlId).css(b.controlWrapperStyles).append(c.captureButton).append(c.loadButton).append(c.dataWrapper).appendTo(c.body)},e.captureEntries=function(){var b,d,f,g,h=[];return d=c.timeList.children(".hcf-TimeSheet-Task"),g=c.dataCheckbox.prop("checked"),d.length&&(f=e.retrieveEntries(),b=f?confirm("Overwrite previous snapshot?"):!0)?(d.each(function(){var b=a(this);h.push({taskId:b.attr("data-taskid"),hours:g?b.find(".hcf-TimeSheet-Time-Input").val():null,description:g?b.find("textarea").val():null,reference:g?b.find(".hcf-TimeSheet-Reference").children("input").val():null,SRED:g?b.find("input:checkbox").val():null})}),h):void 0},e.populateEntries=function(b){b&&b.length&&a.each(b,function(a,b){var d;c.taskList.children('[data-taskid="'+b.taskId+'"]').trigger("click"),d=c.timeList.children('[data-taskid="'+b.taskId+'"]').last(),b.hours&&d.find(".hcf-TimeSheet-Time-Input").val(b.hours).trigger("change"),b.description&&d.find("textarea").val(b.description).trigger("change"),b.reference&&d.find(".hcf-TimeSheet-Reference").children("input").val(b.reference).trigger("change"),b.SRED&&d.find("input:checkbox").val(b.SRED).trigger("change")})},e.saveEntries=function(a){a&&a.length&&(localStorage.setItem(b.dataId,JSON.stringify(a)),e.flash())},e.retrieveEntries=function(){return JSON.parse(localStorage.getItem(b.dataId))},e.flash=function(){var d;d=a("<div>").css(b.flashStyles).appendTo(c.body),setTimeout(function(){d.css("opacity","0"),setTimeout(function(){d.remove()},800)},100)},e.init=function(){e.addControls()},e.init()}(jQuery);